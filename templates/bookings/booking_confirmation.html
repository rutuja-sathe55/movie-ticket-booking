{% extends 'base.html' %}
{% load static %}

{% block body_attrs %}data-page="booking-confirmation"{% endblock %}

{% block title %}{{ booking.booking_id }} - CineBook{% endblock %}

{% block content %}
<!-- Success Header -->
<div style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 40px 0;">
    <div class="container text-center">
        <div style="font-size: 4rem; margin-bottom: 20px; animation: slideInDown 0.6s ease-out;">
            <i class="fas fa-check-circle"></i>
        </div>
        <h1 class="display-5 fw-bold mb-2">Booking Confirmed!</h1>
        <p class="lead" style="opacity: 0.95;">Your booking has been successfully confirmed. Your tickets are ready to download.</p>
    </div>
</div>

<!-- Main Content -->
<div class="container py-5">
    <!-- Booking Summary Card -->
    <div class="row mb-4">
        <div class="col-lg-8 mx-auto">
            <div class="card border-0 shadow-lg">
                <div class="card-header" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white;">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h5 class="mb-0 fw-bold">
                                <i class="fas fa-ticket-alt me-2"></i>Booking ID: {{ booking.booking_id }}
                            </h5>
                        </div>
                        <div class="col-md-6 text-md-end text-start">
                            <h4 class="mb-0 fw-bold" style="font-size: 1.8rem;">₹{{ booking.final_amount }}</h4>
                        </div>
                    </div>
                </div>
                
                <div class="card-body">
                    <!-- Movie Details Section -->
                    <h5 class="fw-bold mb-4">
                        <i class="fas fa-film me-2" style="color: var(--secondary-color);"></i>Movie Details
                    </h5>
                    
                    <div class="row mb-4">
                        <div class="col-md-6 mb-3">
                            <div style="background: #f5f7fa; padding: 15px; border-radius: 10px; border-left: 3px solid var(--accent-color);">
                                <small style="color: var(--text-light);">Movie</small>
                                <div class="fw-bold">{{ booking.show.movie.title }}</div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div style="background: #f5f7fa; padding: 15px; border-radius: 10px; border-left: 3px solid var(--secondary-color);">
                                <small style="color: var(--text-light);">Theatre</small>
                                <div class="fw-bold">{{ booking.show.screen.theatre.name }}</div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div style="background: #f5f7fa; padding: 15px; border-radius: 10px; border-left: 3px solid var(--purple-accent);">
                                <small style="color: var(--text-light);">Screen</small>
                                <div class="fw-bold">{{ booking.show.screen.name }}</div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div style="background: #f5f7fa; padding: 15px; border-radius: 10px; border-left: 3px solid #ff6b35;">
                                <small style="color: var(--text-light);">Date & Time</small>
                                <div class="fw-bold">{{ booking.show.show_date|date:"d M, Y" }} at {{ booking.show.show_time }}</div>
                            </div>
                        </div>
                    </div>
                    
                    <hr>
                    
                    <!-- Tickets Section -->
                    <h5 class="fw-bold mb-4 mt-4">
                        <i class="fas fa-receipt me-2" style="color: var(--secondary-color);"></i>Your Tickets
                    </h5>
                    
                    {% if booking.tickets.all %}
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr style="background: linear-gradient(135deg, #667eea, #764ba2); color: white;">
                                        <th class="fw-bold">Ticket ID</th>
                                        <th class="fw-bold">Seat</th>
                                        <th class="fw-bold">Price</th>
                                        <th class="fw-bold">Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for ticket in booking.tickets.all %}
                                    <tr>
                                        <td class="fw-bold">{{ ticket.ticket_id }}</td>
                                        <td>
                                            <span class="badge bg-info fw-bold">{{ ticket.seat.row }}{{ ticket.seat.seat_number }}</span>
                                        </td>
                                        <td>
                                            <strong style="color: var(--secondary-color);">₹{{ ticket.final_price }}</strong>
                                        </td>
                                        <td>
                                            <a href="{% url 'bookings:download_ticket' ticket.ticket_id %}" class="btn btn-sm btn-primary fw-bold">
                                                <i class="fas fa-download me-1"></i>Download
                                            </a>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    <!-- Action Buttons -->
    <div class="row mb-4">
        <div class="col-lg-8 mx-auto">
            <div class="d-flex flex-wrap gap-3 justify-content-center">
                <a href="{% url 'bookings:booking_download' pk=booking.pk %}" class="btn btn-success btn-lg fw-bold">
                    <i class="fas fa-download me-2"></i>Download All Tickets (PDF)
                </a>
                <a href="{% url 'bookings:booking_list' %}" class="btn btn-primary btn-lg fw-bold">
                    <i class="fas fa-list me-2"></i>View All Bookings
                </a>
                <a href="{% url 'movies:movie_list' %}" class="btn btn-outline-primary btn-lg fw-bold">
                    <i class="fas fa-plus me-2"></i>Book More
                </a>
            </div>
        </div>
    </div>
    
    <!-- Important Info -->
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <div style="background: #e3f2fd; border-left: 4px solid var(--accent-color); padding: 20px; border-radius: 10px;">
                <h6 class="fw-bold mb-3">
                    <i class="fas fa-info-circle me-2" style="color: var(--accent-color);"></i>Important Information
                </h6>
                <ul class="mb-0" style="margin-left: 20px;">
                    <li>Please arrive at the theatre 15 minutes before show time</li>
                    <li>Show your ticket (physical or digital) at the theatre entrance</li>
                    <li>Keep your booking ID safe for reference</li>
                    <li>Cancellations must be made 1 hour before show time</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<style>
    @keyframes slideInDown {
        from {
            opacity: 0;
            transform: translateY(-30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>
{% endblock %}
